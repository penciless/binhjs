!function(){var i=window,c=i.Binh,E=c.Router,l=E.navigate;const u={KEY_AUTH_REDIRECTED:"authRedirected",KEY_AUTH_USER:"auth",STATUS_AUTH_NONE:"none",STATUS_AUTH_EXPIRED:"expired",STATUS_AUTH_VALID:"valid"};function e(e){var r,t,n=function(){var e=i.performance;if(e.getEntriesByType){var r=e.getEntriesByType("navigation");if(r&&0<r.length)return r[0].type}if(e.navigation)switch(e.navigation.type){case 0:return"navigate";case 1:return"reload";case 2:return"back_forward";default:return null}return null}();"back_forward"!==n&&(sessionStorage.hasOwnProperty(u.KEY_AUTH_REDIRECTED)?n&&sessionStorage.removeItem(u.KEY_AUTH_REDIRECTED):(sessionStorage.setItem(u.KEY_AUTH_REDIRECTED,!0),n=(n=localStorage.getItem(u.KEY_AUTH_USER))?(r=n.exp<Date.now()/1e3?(localStorage.removeItem(u.KEY_AUTH_USER),u.STATUS_AUTH_EXPIRED):u.STATUS_AUTH_VALID,n.id):(r=u.STATUS_AUTH_NONE,""),t=encodeURIComponent(i.location.href),i.location=e+"&userID="+n+"&status="+r+"&reURL="+t))}function T(e){var r;try{(r=new URL(e)).valid=!0}catch(e){r={valid:!1,error:e}}return r}(c.Auth=e).RedirectHandler=function(a){return a=a||{},function(){var e=E.query(),r=T(e.reURL);if(r.valid)if(i.location.origin!==r.origin)l("/"),console.error(new Error("Not the same origin after redirected from authentication."));else switch(e.status){case"in":n();break;case"new":localStorage.removeItem(u.KEY_AUTH_USER);var t=T(a.clientTokenAPI);t.error?o(e.token):new c.http(t.href).auth(e.token).get(function(e){o(e)});break;default:localStorage.removeItem(u.KEY_AUTH_USER),n()}else l("/"),console.error(r.error);function n(){l(r.href.replace(location.origin,""))}function o(e){(e=function(e){try{return atob(e.split(".")[1])}catch(e){return null}}(e))&&localStorage.setItem(u.KEY_AUTH_USER,e),n()}}}}();