!function(){var i=window,c=i.Binh,l=c.Router,E=l.navigate;const u={KEY_AUTH_REDIRECTED:"authRedirected",KEY_AUTH_USER:"auth",STATUS_AUTH_NONE:"none",STATUS_AUTH_EXPIRED:"expired",STATUS_AUTH_VALID:"valid"};function e(e){var t,r,n=function(){var e=i.performance;if(e.getEntriesByType){var t=e.getEntriesByType("navigation");if(t&&0<t.length)return t[0].type}if(e.navigation)switch(e.navigation.type){case 0:return"navigate";case 1:return"reload";case 2:return"back_forward";default:return null}return null}();"back_forward"!==n&&(sessionStorage.hasOwnProperty(u.KEY_AUTH_REDIRECTED)?n&&sessionStorage.removeItem(u.KEY_AUTH_REDIRECTED):(sessionStorage.setItem(u.KEY_AUTH_REDIRECTED,!0),n=(n=localStorage.getItem(u.KEY_AUTH_USER))?(t=n.exp<Date.now()/1e3?(localStorage.removeItem(u.KEY_AUTH_USER),u.STATUS_AUTH_EXPIRED):u.STATUS_AUTH_VALID,n.id):(t=u.STATUS_AUTH_NONE,""),r=encodeURIComponent(i.location.href),i.location=e+"&userID="+n+"&status="+t+"&reURL="+r))}function T(e){var t;try{(t=new URL(e)).valid=!0}catch(e){t={valid:!1,error:e}}return t}(c.Auth=e).RedirectHandler=function(a){return a=a||{},function(){var e=l.query(),t=T(e.reURL);if(t.valid)if(i.location.origin!==t.origin)E("/"),console.error(new Error("Not the same origin after redirected from authentication."));else switch(e.status){case"in":n();break;case"new":localStorage.removeItem(u.KEY_AUTH_USER);var r=T(a.clientTokenAPI);r.error?o(e.token):new c.http(r.href).auth(e.token).get(function(e){o(e)});break;default:localStorage.removeItem(u.KEY_AUTH_USER),n()}else E("/"),console.error(t.error);function n(){history.replaceState(null,"",t.href),c.Util.emitEvent(window,"load")}function o(e){(e=function(e){try{return atob(e.split(".")[1])}catch(e){return null}}(e))&&localStorage.setItem(u.KEY_AUTH_USER,e),n()}}}}();