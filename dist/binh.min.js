function Binh(e,t){var i=Binh;i.state=new i.State,document.addEventListener("DOMContentLoaded",function n(){document.removeEventListener("DOMContentLoaded",n),(t=t||{}).element=t.element||document.body,i.router=new i.Router(e,t)})}!function(){function i(n,e){var t;if(!e)return arguments.length?o[n]:o;(t=o[n]=o[n]||[]).length<i.limit&&t.push(e)}Binh.iid=function(){return this.iid++}.bind({iid:0});var o={};i.limit=10,Binh.error=i}(),function(){var s,t=Binh,o=t.Component={},r={},u={},c={},a={},f={};function l(n,e){var t=e instanceof Function?e:function(){},i=document.createElement("script");i.src=n,document.head.appendChild(i),i.remove(),i.onload=function(){var n=s;s=null,n instanceof d?n.loaded=i.onload:t(n)},i.onerror=function(){t()}}function h(n,e){function t(){n&&n.forEach(function(n){n()})}e?setTimeout(t):t()}function d(){}o.create=function(n,e){return c[n](e)},o.define=function(i,n){c[i]=n,t[i]=function(n,e){var t=i;return n&&"string"==typeof n?r.hasOwnProperty(n)?r[n]:e instanceof Function?r[n]=o.create(t,e):r[n]=u[t](n,r):n instanceof Function?s=n:e}},o.fake=function(n,e){u[n]=e},t.require=l,t.script=function(n,e){t.prequire([n],e),s=null},t.prequire=function(n,e){var i,o,r=n.length,u=e instanceof Function?e:function(){};r?(i=s=new d,o=[],n.forEach(function(n){var e=f[n];function t(){a[n]=!0,--r||(u(),i.loaded&&i.loaded()),h(e),delete f[n]}a[n]?o.push(t):e?e.push(t):(e=f[n]=[],l(n,t))}),o.length&&h(o,!0)):u()}}(),function(){var c=Binh.Component;function e(n){this.processes={},this.queue=[],n.bind(this)(function(n,e){this.processes[n]=e}.bind(this),Binh.state,Binh.http)}function a(n,e,t){var i,o,r,u=n.processes;return n.fake?u[t]||(u[t]=(i=n,o=e,r=t,function(){i.fake?i.queue.push({type:o,name:r,args:arguments}):i[o](r).apply(null,arguments)})):u[t]}c.define("service",function(n){return new e(n)}),c.fake("service",function(r,u){var n=new e(function(){this.fake=!0}),s={faker:n,url:r,components:u};return Binh.require(r,function(n){if(null==n)throw new Error("Undefined Service: "+r);u[r]=c.create("service",n),e=(n=s).faker,n=s.components[s.url],delete e.fake,e.processes=n.processes;var e,t=e,i=t.queue;if(!t.fake)for(;i.length;){var o=i.shift();t[o.type](o.name).apply(null,o.args)}}),n});var n=e.prototype;n.instant=function(n){return a(this,"instant",n)},n.once=function(n){var e=this,t=!1,i=a(e,"once",n);return function(){t||(t=!0,i instanceof Function&&i.apply(e,arguments))}},n.debounce=function(n,e,t,i){var o,r,u,s=this,c=a(s,"debounce",n);return function(){c instanceof Function&&(r=arguments,t&&!o&&c.apply(s,r),clearTimeout(o),o=setTimeout(function(){t&&(i||u)||c.apply(s,r),u=o=null},e),u=null==u)}},n.throttle=function(n,e){var t=this,i=!1,o=a(t,"throttle",n);return function(){i||(i=!0,o instanceof Function&&o.apply(t,arguments),setTimeout(function(){i=!1},e))}}}(),function(){var n=Binh.Component;function t(n){var e,t,i=this,o=i.id="binh"+Binh.iid(),n=(i.rules=[],n(function(n,e){var t;"string"==typeof n&&(n=n.replace(/\s+/g," "),t="",e instanceof Array&&(t="{"+e.join(";")+"}"),this.rules.push({selector:n,value:t}))}.bind(i))),r=o,u=i.rules,s=u.length;if(s){for(var c=d(r).sheet,a=s-1;0<=a;a--){var f=u[a],l=f.value?f.selector+f.value:f.selector;try{c.insertRule(l)}catch(n){console.log(f.selector,n)}}h(c,r)}e=o,"string"==typeof(s=n)&&((t=d(e+"x")).append(s),t.onload=function(){var n=t.sheet;n&&!n.prefixed&&(h(t.sheet,e),t.onload=null)}),delete i.rules}function h(n,e){!function e(t,i){if(t.prefixed)return;var n;try{n=t.cssRules}catch(n){return(t.timeout=t.timeout||0,200<t.timeout)?Binh.error("css",{error:n,sheet:t}):void setTimeout(function(){t.timeout++,e(t,i)},t.timeout)}var o=n.length,r=i+" ",u=/^binh($|[^\w-])/,s=/^xbinh($|[^\w-])/;for(var c=0;c<o;c++){var a=n.item(c);if(a instanceof CSSStyleRule){var f=a.selectorText;a.selectorText=f.match(u)?f.replace(u,i+"$1"):f.match(s)?f.replace(s,"$1"):r+f}else if(a instanceof CSSImportRule){var f=a.styleSheet,l=f.refs=t.refs||{};if(l[f.href])continue;e(f,i)}a.cssRules&&e(a,i)}t.prefixed=!0}(n,"."+e)}function d(n){var e=document.createElement("style");return e.id=n,document.head.appendChild(e),e}function i(n,e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=n,t.crossOrigin="",document.head.appendChild(t),e&&(t.id=e,t.onload=function(){t.onload=null,h(t.sheet,e)})}n.define("style",function(n){return new t(n)}),n.fake("style",function(n){var e=new t(function(){});return i(n,e.id),e}),Binh.link=function(n){i(n)}}(),function(){var o=Binh.Component;o.define("ui",function(n){return function(n){return this.shared={},n.bind(this)}(n)}),o.fake("ui",function(e,t){var i={fakers:[],url:e,components:t},n=function(){var n,e=this.components[this.url];return e.fake?(n=Binh.el("fake")(),this.fakers.push(n),n.fake=!0,n.args=arguments,n):e.apply(null,arguments)}.bind(i);return n.constructor=o,n.fake=!0,Binh.require(e,function(n){if(null==n)throw new Error("Undefined UI: "+e);var f;t[e]=o.create("ui",n),f=i.components[i.url],i.fakers.forEach(function(n){var e=n.element,t=e.parentNode,i=f.apply(null,n.args),o=i.element;if(i.actions||n.actions){var r,u=i.actions||{},s=n.actions;for(r in s)u[r]=s[r];i.actions=n.actions=u}i.customs&&(n.customs=i.customs),i.styles&&(n.styles=i.styles),t&&t.replaceChild(o,e),delete n.fake,n.set(o||{});for(var c=i,a=c.queue||[];a.length;)a.shift()(c);delete c.queue})}),n})}(),function(){function i(n){function e(){var u=arguments;return l(e,function(n){for(var e=u.length,t=n.element,i=c,o=0;o<e;o++){var r=u[o];i(r)(t,r)}}),e}for(var t in o)e[t]=o[t];return(n.enode=e).element=n,e.constructor=i,e}Binh.ElementNode=i;var o={},t={};function n(n){for(var e=n.length,t=[],i=0;i<e;i++){var o=n[i];"string"==typeof o&&(o=o.trim())&&t.push.apply(t,o.split(/\s+/))}return t}function e(n,e,t){return l(n,function(n){n=n.element.classList;n[e].apply(n,t)})}function r(e,t,n){return t instanceof Function?t.bind(null,e):function(){n.forEach(function(n){n.toggleClass(t,e)})}}o.set=function(e){return l(this,function(n){(n.element=e).enode=n})},o.ready=function(n){return l(this,n)},o.clone=function(e){return l(this,function(n){e instanceof Function&&e(new i(n.element.cloneNode()))})},o.on=function(e,t,i){return l(this,function(n){n.element.addEventListener(e,t,i)})},o.off=function(e,t,i){return l(this,function(n){n.element.removeEventListener(e,t,i)})},o.race=function(n,i,o){var r=(""+n).split(" ");return l(this,function(n){var e=n.element;function t(n){r.forEach(function(n){e.removeEventListener(n,t,o)}),i(n),o&&o.once||e.addEventListener(n.type,i,o)}r.forEach(function(n){e.addEventListener(n,t,o)})})},o.when=function(n,e){var t=h(this,"actions",{});if("string"!=typeof n)for(var i in n)t[i]=n[i];else e instanceof Function&&(t[n]=e);return this},o.action=function(e){var t=h(this,"actions",{});return function(){var n=t[e];if(n)return{value:n.apply(null,arguments)}}},o.subscribe=function(e,t){return l(this,function(n){Binh.state.listen(e,t,n)})},o.swap=function(o){return l(this,function(n){var e=n.element,t=e.parentNode,i=o.element;t&&t.replaceChild(i,e),n.set(i)})},o.empty=function(){return this.clone(this.swap.bind(this))},o.css=function(i){return l(this,function(n){var e,t=n.element.style;for(e in i)t[e]=i[e]})},o.style=function(){for(var n=arguments,e=n.length,t=[],i=0;i<e;i++){var o=n[i],o="string"==typeof o?Binh.style(o):o;t.push(o.id)}return l(this,function(n){var e=h(n,"styles",[]),e=(e.push.apply(e,t),n.element.classList);e.add.apply(e,n.styles)})},o.nostyle=function(){return l(this,function(n){var e=n.element.classList;e.remove.apply(e,n.styles),n.styles=[]})},o.custom=function(){var i=n(arguments);return l(this,function(n){var e=n.customs||[],t=n.element.classList;t.remove.apply(t,e),t.add.apply(t,i),n.customs=i})},o.addClass=o.class=function(){return e(this,"add",n(arguments))},o.removeClass=function(){return e(this,"remove",n(arguments))},o.toggleClass=function(){return e(this,"toggle",arguments)},o.each=function(n,e){var t=n&&n.length;if(t)for(var i=0;i<t;i++)this(e(n[i]))},o.resize=function(o){return l(this,function(n){var e={matched:!1,enode:n},t=function(n,e,t){var i=this;n=i.called?i.matched:!!n,i.called=!0,i.matched===n&&!i.called||(i.matched=n,requestAnimationFrame(r(n,e,t)))}.bind(e);function i(){i.wait||(document.contains(n.element)?(i.wait=1,requestAnimationFrame(function(){i.wait=0,e.called=!1,o(t)})):window.removeEventListener("resize",i))}window.addEventListener("resize",i),setTimeout(i)})},o.screen=function(t,i){return l(this,function(e){r(u<=t,i,[e])(),e.resize(function(n){n(u<=t,i,[e])})})};var u=window.innerWidth,s=(window.addEventListener("resize",function(){u=window.innerWidth}),o.route=function(e){return l(this,function(n){n.router=new Binh.Router(e,{enode:n})})},{object:function(e,n){if(null!=n){if(n instanceof Element)return e.appendChild(n);switch(n.constructor){case Array:n.forEach(function(n){c(n)(e,n)});break;case Binh.Router:case Element:e.appendChild(n.element||n);break;default:for(var t in n)e.setAttribute(t,n[t])}}},function:function(n,e){switch(e.constructor){case d:e=e();case i:n.appendChild(e.element);break;default:var t=e(n);c(t)(n,t)}},undefined:function(){}});function c(n){return s[typeof n]||a}function a(e,n){try{f(e,n)}catch(n){f(e,n)}}function f(n,e){n.appendChild(document.createTextNode(e))}function l(n,e){return n.fake||e(n),n.queue=n.queue||[],e instanceof Function&&n.queue.push(e),n}function h(n,e,t){return n[e]||(n[e]=t)}function d(n){var e=Array.prototype.slice.call(arguments,1),t=document.createElement(n);return t.constructor=Element,new i(t).apply(0,e)}function p(n){return t[n]||(newTag=t[n]=d.bind(0,n))&&(newTag.constructor=d,newTag)}Binh.el=p,Binh.element=function(){for(var n=arguments,e=n.length;e--;)p(n[e]);return t}}(),function(){function n(n){this.url=n,this.parameters=[]}var e=(Binh.http=n).prototype;n.defer=function(n){var arguments=n instanceof Array?n:arguments||[n],e=arguments.length,t=[],i=function(){};t.count=0,t.results=[],t.ready=function(n){this.count++,this.results[n.index]=n,this.count===this.length&&i instanceof Function&&i.apply(null,this.results)};for(var o=0;o<e;o++){var r=arguments[o];r.defers=r.defers||[],r.defers.push({defer:t,index:o}),t.push(r)}return{done:function(n){i=n instanceof Function?n:function(){}}}},e.get=function(n){return this.request("GET",n)},e.post=function(n){return this.request("POST",n)},e.request=function(n,e){var t,i=this.init(e),o=(i.open(n,this.url+this.parameters.join("/")+(this.queries||"")),this.payload&&i.setRequestHeader("Content-Type","application/json"),this.headers);for(t in o)i.setRequestHeader(t,o[t]);return i.send(this.payload),this},e.init=function(n){var t=this,i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var e;try{e=JSON.parse(i.responseText)}catch(n){e=i.responseText}n instanceof Function&&n(e,i),t.defers instanceof Array&&t.defers.forEach(function(n){n.defer.ready({response:e,xhttp:i,index:n.index})})}},i},e.header=function(n){return this.headers=n,this},e.body=function(n){return this.payload=JSON.stringify(n),this},e.parameter=function(n){var e;return n instanceof Array&&(e=this.url[this.url.length-1],this.parameters=("/"===e?[]:[""]).concat(n)),this},e.query=function(n){var e,t="";for(e in n)t+=e+"="+n[e]+"&";return this.queries="?"+t,this}}(),function(){function c(i,n){var o,r=!0,u=this,i=i||{},n=n||{},s=(u.enode=n.enode||{},u.element=u.enode.element||n.element||document.createElement("div"),u.constructor=c,u.load=function(n){var e,t;r||document.contains(u.element)?(e=!(n instanceof Event),((t=i[location.pathname]||i[""])&&t!==o||e)&&("localhost"===location.hostname&&(console.log("--------------------"),console.log("Location:",location.href),console.log("Load Route:",location.pathname),console.log("Event:",n?n.type:"route"),console.log("Element:",u.element),console.log("Component:",t,typeof t),console.log("Query:",c.query())),a[typeof(o=t)](t,u))):(window.removeEventListener("popstate",s),window.removeEventListener("load",s))});window.addEventListener("popstate",s),window.addEventListener("load",s),e&&(e(),e=null),u.load(),r=!1}Binh.Router=c;var e,t=function(){};function n(){if(!n.init)return n.init=!0;t()}window.addEventListener("popstate",n),window.addEventListener("load",n),c.onroute=function(n){n instanceof Function&&(t=e=n)},c.navigate=function(n,e){history.pushState(e||{},null,n),Binh.Util.emitEvent(window,"load")},c.query=function(e){var t,i=[],o=JSON.stringify;return location.search.substring(1).split("&").forEach(function(n){if(!e)try{n=decodeURIComponent(n)}catch(n){}t=n.split("="),i.push(o(t.shift())+":"+o(t.join("=")))}),JSON.parse("{"+i.join(",")+"}")};var a={string:function(n,e){n=Binh.ui(n);a.function(n,e)},number:function(n,e){e.element.appendChild(document.createTextNode(n))},function:function(n,e){var t,i,o,n=n.element||n();if("string"==typeof n)return this.string(n,e);(n instanceof Element||(n=n.element)instanceof Element)&&(i=(t=e.element).parentNode,(o=t.cloneNode()).appendChild(n),i&&i.replaceChild(o,t),e.enode.element=o,e.element=o)},undefined:function(){}}}(),Binh.State=function(){var t={};function o(n){var e=t[n]||{};return t[n]=e}this.set=function(n,e){var t=o(n);t.value=e,this.emitLater(n,t)},this.edit=function(n,e){var t=o(n);e(t.value),this.emitLater(n,t)},this.emitLater=function(n,e){var t=this;clearTimeout(this.emitId),this.emitId=setTimeout(function(){t.emit(n,e)})},this.emit=function(n,t){(t=t||o(n)).listeners instanceof Array&&t.listeners.forEach(function(n,e){if(function(n){var e=n.enode,t=e&&e.element instanceof Element,e=document.contains(e.element),i=n.domed;e&&!i&&(n.domed=!0);return t&&i&&!e}(n))return t.listeners.splice(e,1);e=JSON.parse(JSON.stringify(t.value));n.handler(e)})},this.listen=function(n,e,t){var i=o(n);i.listeners=i.listeners||[],i.listeners.push({enode:t,handler:e}),this.update(n,i),null!=i.value&&e(i.value)},this.schema=function(n,e){var t=o(n);e instanceof Function&&(t.fetch=e,t.listeners)&&t.listeners.length&&this.update(n,t)},this.update=function(e,t){var i;(t=t||o(e)).fetch instanceof Function&&(t.fetching||(t.fetching=!0,i=this,t.fetch(function(n){i.set(e,n),t.fetching=!1})))},this.as=function(n){var e=o(n);if(e.as)return e.as;var t,i=e.as={};for(t in this)i[t]=this[t].bind(this,n);return i}},Binh.Util={emitEvent:function(n,e){var t;document.createEvent?("function"==typeof Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!1,!0),n.dispatchEvent(t)):((t=document.createEventObject()).eventName=t.eventType=e,n.fireEvent("on"+t.eventType,t))}};