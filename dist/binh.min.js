function Binh(n,t){var i=Binh;i.state=new i.State,document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),(t=t||{}).element=t.element||document.body,i.router=new i.Router(n,t)})}Binh.iid=function(){return this.iid++}.bind({iid:0}),function(){var c,t=Binh,o=t.Component={},r={},u={},s={},a={},f={};function l(e,n){var t=n instanceof Function?n:function(){},i=document.createElement("script");i.src=e,document.head.appendChild(i),i.remove(),i.onload=function(){var e=c;c=null,e instanceof d?e.loaded=i.onload:t(e)},i.onerror=function(){t()}}function h(e,n){function t(){e&&e.forEach(function(e){e()})}n?setTimeout(t):t()}function d(){}o.create=function(e,n){return s[e](n)},o.define=function(i,e){s[i]=e,t[i]=function(e,n){var t=i;return e&&"string"==typeof e?r.hasOwnProperty(e)?r[e]:n instanceof Function?r[e]=o.create(t,n):r[e]=u[t](e,r):e instanceof Function?c=e:n}},o.fake=function(e,n){u[e]=n},t.require=l,t.script=function(e,n){t.prequire([e],n),c=null},t.prequire=function(e,n){var i,o,r=e.length,u=n instanceof Function?n:function(){};r?(i=c=new d,o=[],e.forEach(function(e){var n=f[e];function t(){a[e]=!0,--r||(u(),i.loaded&&i.loaded()),h(n),delete f[e]}a[e]?o.push(t):n?n.push(t):(n=f[e]=[],l(e,t))}),o.length&&h(o,!0)):u()}}(),function(){var s=Binh.Component;function n(e){this.processes={},this.queue=[],e.bind(this)(function(e,n){this.processes[e]=n}.bind(this),Binh.state,Binh.http)}function a(e,n,t){var i,o,r,u=e.processes;return e.fake?u[t]||(u[t]=(i=e,o=n,r=t,function(){i.fake?i.queue.push({type:o,name:r,args:arguments}):i[o](r).apply(null,arguments)})):u[t]}s.define("service",function(e){return new n(e)}),s.fake("service",function(r,u){var e=new n(function(){this.fake=!0}),c={faker:e,url:r,components:u};return Binh.require(r,function(e){if(null==e)throw new Error("Undefined Service: "+r);u[r]=s.create("service",e),n=(e=c).faker,e=c.components[c.url],delete n.fake,n.processes=e.processes;var n,t=n,i=t.queue;if(!t.fake)for(;i.length;){var o=i.shift();t[o.type](o.name).apply(null,o.args)}}),e});var e=n.prototype;e.instant=function(e){return a(this,"does",e)},e.once=function(e){var n=this,t=!1,i=a(n,"once",e);return function(){t||(t=!0,i instanceof Function&&i.apply(n,arguments))}},e.debounce=function(e,n,t,i){var o,r,u,c=this,s=a(c,"debounce",e);return function(){s instanceof Function&&(r=arguments,t&&!o&&s.apply(c,r),clearTimeout(o),o=setTimeout(function(){t&&(i||u)||s.apply(c,r),u=o=null},n),u=null==u)}},e.throttle=function(e,n){var t=this,i=!1,o=a(t,"throttle",e);return function(){i||(i=!0,o instanceof Function&&o.apply(t,arguments),setTimeout(function(){i=!1},n))}}}(),function(){var e=Binh.Component;function t(e){var n,t,i=this,o=i.id="binh"+Binh.iid(),e=(i.rules=[],e(function(e,n){var t;"string"==typeof e&&(e=e.replace(/\s+/g," "),t="",n instanceof Array&&(t="{"+n.join(";")+"}"),this.rules.push({selector:e,value:t}))}.bind(i))),r=o,u=i.rules,c=u.length;if(c){for(var s=d(r).sheet,a=c-1;0<=a;a--){var f=u[a],l=f.value?f.selector+f.value:f.selector;try{s.insertRule(l)}catch(e){console.log(f.selector,e)}}h(s,r)}n=o,"string"==typeof(c=e)&&((t=d(n+"-txt")).append(c),t.onload=function(){t.sheet&&h(t.sheet,n)}),delete i.rules}function h(e,n){!function n(t,i){var e;try{e=t.cssRules}catch(e){if(t.timeout=t.timeout||0,200<t.timeout)throw e;return void setTimeout(function(){t.timeout++,n(t,i)},t.timeout)}var o=e.length;for(var r=0;r<o;r++){var u=e.item(r);if(u instanceof CSSStyleRule)u.selectorText=i+u.selectorText;else if(u instanceof CSSImportRule){var c=u.styleSheet,s=c.refs=t.refs||{};if(s[c.href])continue;n(c,i)}u.cssRules&&n(u,i)}}(e,"."+n+" ")}function d(e){var n=document.createElement("style");return n.id=e,document.head.appendChild(n),n}function i(e,n){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t),n&&(t.id=n,t.onload=function(){t.onload=null,h(t.sheet,n)})}e.define("style",function(e){return new t(e)}),e.fake("style",function(e){var n=new t(function(){});return i(e,n.id),n}),Binh.link=function(e){i(e)}}(),function(){var o=Binh.Component;o.define("ui",function(e){return function(e){return e.bind(this)}(e)}),o.fake("ui",function(n,t){var i={fakers:[],url:n,components:t},e=function(){var e,n=this.components[this.url];return n.fake?(e=Binh.el("fake")(),this.fakers.push(e),e.fake=!0,e.args=arguments,e):n.apply(null,arguments)}.bind(i);return e.constructor=o,e.fake=!0,Binh.require(n,function(e){if(null==e)throw new Error("Undefined UI: "+n);var s;t[n]=o.create("ui",e),s=i.components[i.url],i.fakers.forEach(function(e){var n=e.element,t=n.parentNode,i=s.apply(null,e.args),o=i.element;if(t&&t.replaceChild(o,n),i.actions||e.actions){var r,u=i.actions||{},c=e.actions;for(r in c)u[r]=c[r];i.actions=e.actions=u}delete e.fake,e.element=o||{},e.ready()})}),e})}(),function(){function i(e){function r(){for(var e=arguments.length,n=r.element,t=u,i=0;i<e;i++){var o=arguments[i];t(o)(n,o)}return r}for(var n in t)r[n]=t[n];return r.element=e,r.constructor=i,e.elementnode=r}Binh.ElementNode=i;var t={},o={};function r(e){return e.actions||(e.actions={})}t.ready=function(e){return a(this,e)},t.clone=function(n){return a(this,function(e){n instanceof Function&&n(new i(e.element.cloneNode()))})},t.on=function(n,t){return a(this,function(e){e.element.addEventListener(n,t)})},t.when=function(e,n){var t=r(this);if("string"!=typeof e)for(var i in e)t[i]=e[i];else n instanceof Function&&(t[e]=n);return this},t.action=function(n){var t=r(this);return function(){var e=t[n];e&&e.apply(null,arguments)}},t.subscribe=function(n,t){return a(this,function(e){Binh.state.listen(n,t,e)})},t.empty=function(){var e=this.element,n=e.parentNode,t=e.cloneNode();return n&&n.replaceChild(t,e),this.element=t,this},t.style=function(n){return n="string"==typeof n?Binh.style(n):n,a(this,function(e){e.element.classList.add(n.id)})};var n={object:function(n,e){if(null!=e)switch(e.constructor){case Array:e.forEach(function(e){u(e)(n,e)});break;case Binh.Router:case Element:n.appendChild(e.element||e);break;default:for(var t in e)n.setAttribute(t,e[t])}},function:function(e,n){switch(n.constructor){case f:case i:e.appendChild(n.element||n().element);break;default:var t=n(e);u(t)(e,t)}},undefined:function(){}};function u(e){return n[typeof e]||c}function c(n,e){try{s(n,e)}catch(e){s(n,e)}}function s(e,n){e.appendChild(document.createTextNode(n))}function a(e,n){var t=e.queue=e.queue||[];if(n instanceof Function&&t.push(n),!e.fake)for(;t.length;)t.shift()(e);return e}function f(e){var n=Array.prototype.slice.call(arguments,1),t=document.createElement(e);return t.constructor=Element,new i(t).apply(0,n)}function l(e){return o[e]||(newTag=o[e]=f.bind(0,e))&&(newTag.constructor=f,newTag)}Binh.el=l,Binh.element=function(){for(var e=arguments,n=e.length;n--;)l(e[n]);return o}}(),function(){function e(e){this.url=e,this.parameters=[]}var n=(Binh.http=e).prototype;e.defer=function(e){var arguments=e instanceof Array?e:arguments||[e],n=arguments.length,t=[],i=function(){};t.count=0,t.results=[],t.ready=function(e){this.count++,this.results[e.index]=e,this.count===this.length&&i instanceof Function&&i.apply(null,this.results)};for(var o=0;o<n;o++){var r=arguments[o];r.defers=r.defers||[],r.defers.push({defer:t,index:o}),t.push(r)}return{done:function(e){i=e instanceof Function?e:function(){}}}},n.get=function(e){return this.request("GET",e)},n.post=function(e){return this.request("POST",e)},n.request=function(e,n){var t,i=this.init(n),o=(i.open(e,this.url+this.parameters.join("/")+(this.queries||"")),this.payload&&i.setRequestHeader("Content-Type","application/json"),this.headers);for(t in o)i.setRequestHeader(t,o[t]);return i.send(this.payload),this},n.init=function(e){var t=this,i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var n;try{n=JSON.parse(i.responseText)}catch(e){n=i.responseText}e instanceof Function&&e(n,i),t.defers instanceof Array&&t.defers.forEach(function(e){e.defer.ready({response:n,xhttp:i,index:e.index})})}},i},n.header=function(e){return this.headers=e,this},n.body=function(e){return this.payload=JSON.stringify(e),this},n.parameter=function(e){var n;return e instanceof Array&&(n=this.url[this.url.length-1],this.parameters=("/"===n?[]:[""]).concat(e)),this},n.query=function(e){var n,t="";for(n in e)t+=n+"="+e[n]+"&";return this.queries="?"+t,this}}(),function(){function e(o,e){var r,u=!0,c=this,o=o||{},e=e||{},s=(c.element=e.element||document.createElement("div"),c.constructor=Binh.Router,c.load=function(e){var n,t,i;u||document.contains(c.element)?(n=!(e instanceof Event),t=location.pathname,((i=o[t]||o["/"+t]||o[""])&&i!==r||n)&&(a(),"localhost"===location.hostname&&(console.log("--------------------"),console.log("Load Route:",t),console.log("Location:",location.pathname),console.log("Event:",e?e.type:"route"),console.log("Element:",c.element),console.log("Component:",i,typeof i),console.log("Query:",c.query())),r=i,c.handlers[typeof i](i,c))):(window.removeEventListener("popstate",s),window.removeEventListener("load",s))});window.addEventListener("popstate",s),window.addEventListener("load",s),c.load(),u=!1}var n=(Binh.Router=e).prototype,a=function(){};e.onload=function(e){e instanceof Function&&(a=e)},n.navigate=function(e,n){history.pushState(n||{},null,e),Binh.Util.emitEvent(window,"load")},e.navigate=n.navigate,n.REGEX_ROUTE=new RegExp(".*/(.*?)(/|$).*"),n.currentRoute=function(){return location.pathname.replace(this.REGEX_ROUTE,"$1")},n.REGEX_QUERIES=/(.*?)=(.*?)(&|$)/g,n.query=function(){return JSON.parse("{"+decodeURIComponent(location.search.substring(1).replace(this.REGEX_QUERIES,'"$1":"$2",').slice(0,-1))+"}")},n.handlers={string:function(e,n){e=Binh.ui(e);n.handlers.function(e,n)},number:function(e,n){n.element.appendChild(document.createTextNode(e))},function:function(e,n){var t,i,o,e=e.element||e();if("string"==typeof e)return this.string(e,n);(e instanceof Element||(e=e.element)instanceof Element)&&(i=(t=n.element).parentNode,(o=t.cloneNode()).appendChild(e),i&&i.replaceChild(o,t),n.element=o)},undefined:function(){}}}(),Binh.State=function(){var t={};function o(e){var n=t[e]||{};return t[e]=n}this.set=function(e,n){var t=o(e);t.value=n,this.emitLater(e,t)},this.edit=function(e,n){var t=o(e);n(t.value),this.emitLater(e,t)},this.emitLater=function(e,n){var t=this;clearTimeout(this.emitId),this.emitId=setTimeout(function(){t.emit(e,n)})},this.emit=function(e,t){(t=t||o(e)).listeners instanceof Array&&t.listeners.forEach(function(e,n){if(function(e){var n=e.elementnode,t=n&&n.element instanceof Element,n=document.contains(n.element),i=e.domed;n&&!i&&(e.domed=!0);return t&&i&&!n}(e))return t.listeners.splice(n,1);n=JSON.parse(JSON.stringify(t.value));e.handler(n)})},this.listen=function(e,n,t){var i=o(e);i.listeners=i.listeners||[],i.listeners.push({elementnode:t,handler:n}),this.update(e,i),null!=i.value&&n(i.value)},this.schema=function(e,n){var t=o(e);n instanceof Function&&(t.fetch=n,t.listeners)&&t.listeners.length&&this.update(e,t)},this.update=function(n,t){var i;(t=t||o(n)).fetch instanceof Function&&(t.fetching||(t.fetching=!0,i=this,t.fetch(function(e){i.set(n,e),t.fetching=!1})))},this.as=function(e){var n=o(e);if(n.as)return n.as;var t,i=n.as={};for(t in this)i[t]=this[t].bind(this,e);return i}},Binh.Util={emitEvent:function(e,n){var t;document.createEvent?("function"==typeof Event?t=new Event(n):(t=document.createEvent("Event")).initEvent(n,!1,!0),e.dispatchEvent(t)):((t=document.createEventObject()).eventName=t.eventType=n,e.fireEvent("on"+t.eventType,t))}};